
30.05.2001	administrative changes

	routines on regular files in reg directory (fem3d)
	cvs routines moved to cvs directory (fembin)
	changes in git* routines

17.05.2011	minor enhancements

	compiler warnings in qfcheck() (subqfxf.f)
	new routine check_set_unit() to set output unit (newchk.f)
	new routines skadar_debug() and wet_dry() (subcus.f)
	new routines to adjourn depth (subdep.f)

17.05.2011	plotting of node/element number

	in plobas may plot node and element numbers (supsim.f)
	new routine basin_number() (supbas.f)


19.04.2011	compiler warnings in MACOSX

	introduced HAVE_WIDGET for compiler errors (xgraph.[ch], general.h)

========================================================== 14-04-2011 - 6_1_22

31.03.2011	check in vp, write of temp/salt

	new routine check_sidei(), text in optest() (vp.f)
	only write temp/salt if computed (newbcl.f)

31.03.2011	no plot in dry areas

	new arrays fvlv, arfvlv (plotsim.f)
	read fvl file (supsim.f)
	new routine elemmask() (subreg.f)
	new routine mkareafvl() (supdep.f)
	write finite volumes at initial time step (ht.f)
	routines to handle fvl files (supout.f)

30.03.2011	heatgotm, small changes

	bug in heatgotm() -> convert pressure to Pascal (subqfxm4.f)
	more sanity tests in pre-processing (vp.f, subcmv.f)
	new routines to delete elements (bastreat.f)
	in plot new routines to handle fvl files (supout.f)
	
25.03.2011	small changes

	new parameters iheat,hdecay,botabs (subsys.f,subqfxt.f)
	error check for aapar and itvdv(newcon.f)
	bug fix in bndo_impbc() -> ibcold not initialized (subbndo.f)

========================================================== 01-03-2011 - 6_1_21

23.03.2011	heatgotm, siphe, itvdv

	itvdv
		new parameter itvdv (newcon.f,subsys.f)
	heat fluxes
		bug in heatgotm() -> avoid wind speed == 0 (subqfxm4.f)
		new routine check_heat() to check for Nan (subqfxt.f)
		new iheat (subqfxt.f)
	isphe (bug)
		new routine adjust_spherical() (newini.f,ht.f)
		get isphe through get_coords_ev() (newtvd.f)
		better set-up and error check for isphe_ev and isphe 
			(newini.f, subnev.f)

04.03.2011	heatgotm

	heat module from gotm extracted (subqfxm4.f)
	new routine heatgotm (subqfxt.f)

========================================================== 01-03-2011 - 6_1_20

01.03.2011	levflx

	implement smoothing for levflx (subn11.f)

25.02.2011

	new param wsmax to catch errors in wind type (subwin.f, subsys.f)
	new routine decay_conz_variable(), add t90 time scale (newconz.f)
	new routine nossum.f
	new directory hcbs -> libgrappa

23.02.2011

	new parameters tramp and levflx implemented (subn11.f, subbnd.f)
	smoothing for levflx
	new routine call write_node_fluxes() for special output (subflxa.f)
	in pritime() new write to terminal (subnsh.f)
	error check for dzreg, nsigma and levels (newini.f)

19.02.2011

	3D radiation stress (new3di.f)

========================================================== 18-02-2011 - 6_1_19

18.02.2011

	general framework for ecological model
		ecological_dummy.f
	new radiation stress in 3D
		ht.f, subwwm.f
	./fem3d/subrgf.f: bug fix in rgf_check_header() -> get instead of set

========================================================== 17-02-2011 - 6_1_18

16.02.2011

	lat/lon
		changed default for isphe -> always automatic (subsys.f)
	meteo restructured
		subrgf.f completely restructured - store geo information
		pstd introduced (subqfxm3.f subqfxm1.f,subwin.f)
		pass idata to files, use geo info from files (submeteo.f)
		new file submet.f (from subn11.f)
		conversion from specific humidity (not working) (subqfxu1.f)
	projection
		new projection 4 (non standard UTM)
	aquabc
		new files included
		some helper routines to deal with nodal area code (subn35.f)
	nudging
		pass robs to subroutines (newcon.f, newstab.f)
	grid
		pass type into routines for creation of items
		new options OpOutFile, OpItemType
		new routine savestr()
	minor
		new routine trimline() (subsss.f)
		in diffweight() use double precision (subdif.f)
		new routines e2n3d() and e2n3d_minmax() (newtra.f)
		write n2max to info file (subgotm.f)

05.02.2011	submeteo restructured

	changed order of records in dfile (actual is first) (submeteo.f)

28.01.2011	tvd for lat/lon

	tvd for lat/lon
		bug fix for distance with lat/lon (tvd_fluxes) (newtvd.f)
		insert ISPHE for lat-long coordinates
		new entry in ev for distance of nodes (17-19) (subnev.f)

	nudging
		parameters changed in call to ts_nudge() (newbcl.f)

========================================================== 27-01-2011 - 6_1_17

27.01.2011	nudging

	nudging (t/s/cobs, bobs)
		./fem3d/newcon.f:
		./fem3d/newbcl.f:
		./fem3d/ht.f:
		./fem3d/newstab.f:
	new routines for maniploating grd/bas files
		./fem3d/basres.f:
		./fem3d/basproj.f:
		./fem3d/grdutil.f:
	new default for isphe for lat/lon
		./fem3d/subnev.f:
	./fem3d/subreg.f:
		handling extrapolation in am2av(
		bug fix in find_elem_from_old() BUG_27.01.2011

21.12.2010	plot of sigma layers

	vertical velocity section plotting with sigma
		./femplot/suplin.f:

========================================================== 20-12-2010 - 6_1_16

17.12.2010	plot of sigma layers

	in sp256w() account for changing volume (sigma)

	substituted hv with hkv
	new routine hlthick() (supdep.f)

========================================================== 16-12-2010 - 6_1_15

16.12.2010	sigma layers (first implementation)

	sigma layers partially finished
		./fem3d/newbcl.f:
		./fem3d/newini.f:
		./fem3d/newexpl.f:
		./fem3d/subele.f:
		./fem3d/subsys.f:
		./fem3d/newsig.f:
	bug fix in copy_depth (basbathy.f)
	in depadj() do not set hm3v to constant (subdep.f)
	nsigma and bsigma renamed
		./fem3d/newfix.f:
		./fem3d/newbsig.f:
	new file ousutil.f
	map_influence.f restructured to use volume file

========================================================== 15-12-2010 - 6_1_14

15.12.2010	vertical TVD

	bug fix in convert_coords for mode=-1 (subcoord.f)
	bug fix in vert_aver() (map_influence.f)

	new routine vertical_flux_ie() for vertical tvd
	traccia routines moved to subtrace.f

	ousvdiff.f prepared to use for water level differences
	ousextr_gis.f new for 3D gis output
	in map_influence.f write all conz to one file

09.10.2010

	better error handling for CircumCircle Error (meshge.c)
	better labeling of reference arrow in vertical plot
	in oktime() handle negative itfreq (suptim.f)

========================================================== 08-10-2010 - 6_1_13

08.10.2010
	bug fix in init_coriolis() -> ym not set for isphe=1 (newini.f)
	new routines for purging nodes after unifying (exgrd.c)
	general cleaning of directories

30.09.2010
	new vars itmin/itmax to limit writing in ousintp.f

========================================================== 29-09-2010 - 6_1_12

29.09.2010
	new routine PsArcFill()
	finished velocity plot with reference arrow

========================================================== 28-09-2010 - 6.1.11

28.09.2010
	bug fix in init_coriolis() for isphe=1, new value for icor

========================================================== 26-07-2010 - 6.1.10

========================================================== 22-07-2010 - 6.1.9

05.07.2010
	new routine dist_point_to_line(), bug fix in inpoly1() (subgeo.f)
	shell to compute energy, new routine for computing 3D kin/pot energy
	new way to compute area of polygon (stable for 64 bit)  (gridut.c)

========================================================== 03-05-2010 - 6_1_8

29.04.2010
	write volumes (wrfvla)

========================================================== 26-04-2010 - 6_1_7

========================================================== 26-04-2010 - 6.1.6

26-04-2010
	new UTM projection

========================================================== 22-04-2010 - 6.1.5

14.04.2010
	account for negative levmin/max
	ad hoc routine for Yaron (momentum input, unfinished) (new3di.f)
	spheric coordinates: new routines get_coords_ev(), check_spheric_ev()
	bug fix in frac_pos() -> maybe compiler error (supbas.f)

26.03.2010
	vertical plot for velocity finished (also spherical coordinates)
	new parameters for arrows in section plot
	make it easier to change between color tables

22.03.2010
	bug fix for evaporation in newcon.f:
		evaporation was not computed correctly due to the
		treatment of negative fluxes in a way appropriate only
		for open boundary nodes -> check for OBC
	small bug in subn11:
		forgotten to initialize sconz
	new inpoly in subgeo.f:
		faster way to compute in-poly check for arbitrary polygons

11.03.2010
	check for negative volumes (node and element) in newtra.f
	min/max property not for ibtyp=1 (newcon.f)
	write also vertical velocity for restart

10.03.2010
	bug fix in new3di.f
		-> compute vertical velocities also for ibtyp=2
		-> otherwise tracer over/under-shoot can happen

08.03.2010
	use bformat to decide on initial read in newbcl.f
	bug fix in newstab.f, newexpl.f
		-> only run down to avail levels

01.03.2010
	new map_influence.f
	tramp in subn11.f
	grid quality in basinf.f
	some changes in newtra.f
	new routine jamal_fra in subcus.f

26.02.2010
	new computation of stability for advection in momentum equation
	bug fix in make_scal_flux() (subn11.f)
	compilor warnings eliminated

22.02.2010
	new file for stability condition computation -> simplified
		viscous_stability for dt=1
	subwin.f restructured
		new arrays wxv, wyv
		new itdrag for smith and Banke etc..
		computes wind if stress is given
	new routine for tidal potential

16.02.2010
	new stability constraints for T/D (with point sources)
	new diffusion matrix
	new method for imposing BC on T/D (fluxes and concentrations)

18.11.2009
	in jamal correct residence time

13.11.2009
	in restart keep track of what has been read
	only initialize T/S if no restart file has been read
	(rhov and bpresv might need special treatment)

12.11.2009
	problems of negative tracers at negative discharge boundary condition
	-> solved by moving make_scal_flux() into time loop (newcon.f)
	now it uses always the right ambient tracer concentration
	added new routine is_zeta_bound(k) to subbndo.f

11.11.2009
	handle abosrption of short rad in more than one layer (subqfxt.f)

14.10.2009
        in plotsim.f new arrays for section plot
        in supano.f changes to colbar, new inbox routines
        in supdep.f new routine mkht3 to set depth structure
        in supout.f set nlv once file is read
        in supsim.f section plot for velocities in plosim
        in suplin.f vertical plot finished (scalar and velocities)
        new files basin.h line_nodes.f suplin1.f

13.10.2009
	new section $sect to plot vertical section has been introduced

29.05.2009
	new ityrst for options in restarting

26.05.2009
	basic projection in subcoord.f
	use new projection in submeteo.f (to be finished)
	scalar interpolation (not finished) in new3di.f
	new setting for lat/lon coordinates in subnev.f

21.05.2009
	new basbathy (interpolation on nodes, latlon)
	new bastreat (still to be finished)

30.04.2009
	new routines to read grd and not bnd file 
		(still to finish implementation)

29.04.2009
	links restructured 
		(subwat,subuti,sublin,sedi3d,bdist)
		(subflxa,flux,lagrange_flux)
		(links,sublnka,sublnka,sublnku)

27.04.2009
	ktilt and ztilt together (subn11,subbnd)

24.04.2009
	new routine rdgrd implemented (basbathy,vp,subgrd,adjele)
	test for parallel execution (newcon)

21.04.2009
	new inic2fill() (newini)
	in femplot allow for constant value in color plot (supano,col)

20.04.2009	version  5.28
	ztilt implemented
	check again for band width
	delete level.h in femplot

06.04.2009	version  5.27
	bug fix in newtvd
		instead of testing (conc==cond) now (abs(conc-cond) < eps)
		created NaN in 64 bit architecture
	adjust param.h from Rules.make
	all files now read param.h
	new routines in newchk.f for checking nodes/elems
	nlidim renamed to nlkdim

03.04.2009	version  5.26b
	bug fix for lagrangian interpolation (unstable)
		use of lagrangian interpolation routine with "strange"
		data (times 1,2,120000,30000000) would lead to
		unrealistic results on 64 bit architecture
	intpol default is 0 (4 for ibtyp=1, 2 else)
	eliminated compiler warnings for gfortran
	in sparskit routines substituted assigned goto with if

31.03.2009	version  5.26
	tvd scheme integrated 
		for general use itvd=2 is recommended
	sparskit integrated
	gauss elimination tested with double precision (see simsys_lp.f)
	some changes to code for regular matrices

27.03.2009
	bug fix for dry nodes -> call adjust_mass_flux()
		results was a mass conservation error

13.03.2009
	bug fix in subsys.f -> for some parameters wrong default section

11.03.2009
	new code for regular matrices:
		new: submeteo, subrgf, subcoord
		new calls to: meteo_regular, meteo_set_matrix, meteo_get_values
		changed: subqfxf, subqfxt, subn11, subsys

27.01.2009
	new routine scal_intp to interpolate scalar variables
	bug fix in post routines
	routines from Andrea integrated (TVD, semi-lagrangian)

18.12.2008
	bugfix in GOTM modul -> problem for 2 layers -> viscosity
	bugfix in subgotm.f -> ss can be negative -> abs() statements used
	new rfricv for bottom friction in new3di.f (computed in subn35.f)

08.11.2008
	bugfix in conz3d (newcon) -> 
		must compute vertical velocity on right time
		both for mass and tracer conservation

08.10.2008
	data flow for boundary conditions:

                call scal_bnd('temp',t,bnd3_temp)
	        	call bnds_set(what,t,nb3dim,bnd3,bnd3_aux)
				call exfintp(array(1,ibc),t,aaux)
				call exfset(array(1,ibc),t,aaux)
                call scal_adv
        		call bnds_trans
        		call scal3sh
				call make_scal_flux
				call conz3d
				call bndo_setbc


03.09.2008
	in STR use nbdim as number of levels given in data file
		-> must be equal to lmax given in file

30.04.2008
	for profiling: Intel thread profiler
		-openmp-profile
		-openmp-report{1|2}

	could make better structure for diagnostic variables:
		T/S, bio
		maybe use time series

	should condense some subroutines:
		concmass, concmass1
		massconc
		tsmass
		scalmass
		totcon

18.01.2008
	* bio3d still broken
	* ousaver.f still broken
	lagrange with continuous release (lagrange_cont.f)
	new file nosdiff_deb.f in var

25-01-2005
	bug in advective terms (BUGADV) -> fixed in new3di.f

15-10-2004
	checkerboard plots derive from wrong write (nlvdim) of confil

22-09-2004
	newdat.f substituted by subdts.f

15-08-2003
	structure of ht file:

		set dimensions

		read STR file

		check dimensions
		check STR file

		set up ev and geom arrays

		initialize vertical levels
		initialize coriolis, eddy, austausch

		initialize chezy

		initialize boundary conditions (sp111)
		initialize z

		set depth arrays

		update geom, iwegv, inodv

		initialize u

		other modules

11-04-2003
	albedo introduced in file subqfxt
	
10-04-2003
	problems with negative temp solved -> new routine wbt in subqfxu1.f
	
14-10-2002
	atpar, adpar,aapar -> default is now 1.0 (fully implicit)
	thdif = shdif in barcl (FIXME)
	diffset introduced eberywhere and largely commented
	use itsmed (subroutine tsmed) to produce min/max/med of S/T in file tsa
	
03-09-2002
	averaging for TS introduced (tsmed)
	sanity_check introduced into ht (newchk.f)
	bug in subflxa.f (ggu99) -> reproduce ???

07-12-2001
	version 4.63

05-12-2001
	fixed compiler error with -Wall -pedantic
	new routines diffstab,diffstab1,difflimit
	variable horizontal diffusion, limit on dif.coef.
	horizontal diffusion variable, limit diffusion coef.
	compute istot, more debug info
	always execute tstvol, more debug info
	subbndo.f: NTBC - BUG -> has not been set before

03-12-2001
	new arrays [cst]difhv
	subbndo.f: LEVMX - look out for missing level of near node

21-11-2001
	Handle ambient input of water with ibtyp=3 -> -999.
	routines to handle advective index (aix)

19-11-2001
	eliminated h1hv,ulv,vlv - centralized hlhv, hldv

16-11-2001
	version 4.62

16-11-2001
	subroutine conmima and diffstab
	dynamic computation of istot (rstot) introduced

14-11-2001
	all compiler directives have been eliminated
	no .F files left
	makefile renamed into Makefile

12-11-2001
	rcv in subcon was not in common block -> who removed it
	baroxv, baroyv, adauxv, adauxv commented out in ht (not used)

08-01-2001
	hp from sediment (4.56) faster than hp from stream (4.60) (ht?)
	ht is not computing flx in mass conserving way
	hp explodes on M2 with venlag62 -> ilin = 1 must be set

09-01-2001
	ht is not conserving tracer (conz)

12-01-2001
	mass conservation has been restored passing from dz computation
	to direct znv computation (only three small changes in new3di.F).
	Problem was that zn = zo + dz was violated when levels of zo
	were not the same (just before re-including a dry element).
	Direct computation of zn bypasses this problem.
	The erroneous FLX computation was due to the failure of
	mass conservation of ht

	speed of ht depends on the call of valtest which slows down
	the computation

	conservation of tracers in ht must still be looked at

#------------------------------------------------------------------------

